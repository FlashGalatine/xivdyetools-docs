# FINDING-006: Devalue DoS Vulnerability (Memory/CPU Exhaustion)

## Severity
**HIGH**

## Category
- CWE-405: Asymmetric Resource Consumption (Amplification)
- CWE-20: Improper Input Validation

## Affected Projects
- xivdyetools-oauth
- xivdyetools-presets-api

## Description
The `devalue` package versions 5.1.0 through 5.6.1 are vulnerable to Denial of Service through memory and CPU exhaustion in `devalue.parse()`.

Two related advisories:
1. **GHSA-g2pg-6438-jwpf** (CVSS 7.5): Memory/CPU exhaustion in devalue.parse
2. **GHSA-vw5p-8cq8-m7mv** (CVSS 7.5): Memory exhaustion in devalue.parse

## Evidence
```json
{
  "name": "devalue",
  "severity": "high",
  "range": "5.1.0 - 5.6.1",
  "fixAvailable": true,
  "cwe": ["CWE-405", "CWE-20"],
  "cvss": {
    "score": 7.5,
    "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
  }
}
```

## Impact
An attacker could send specially crafted input that causes:
1. **Memory Exhaustion**: Worker runs out of memory and crashes
2. **CPU Exhaustion**: Worker becomes unresponsive
3. **Service Disruption**: Denial of service for legitimate users

**Note**: This is a transitive dependency through Cloudflare tooling. Direct usage in application code should be audited.

## Recommendation

### Update Dependencies
```bash
npm update devalue
```

Or update the parent package that depends on devalue.

Target version: 5.6.2 or later

## References
- [GHSA-g2pg-6438-jwpf](https://github.com/advisories/GHSA-g2pg-6438-jwpf)
- [GHSA-vw5p-8cq8-m7mv](https://github.com/advisories/GHSA-vw5p-8cq8-m7mv)

## Status
- [x] devalue updated in xivdyetools-oauth (2026-01-25)
- [x] devalue updated in xivdyetools-presets-api (2026-01-25)

**Resolution Date:** 2026-01-25
**Resolution Notes:** Devalue transitive dependency updated via npm audit fix. Vulnerability resolved.
